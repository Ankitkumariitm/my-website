<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title> pdf editor edit pdf add text result reader tools DR.PDF & IMGAGE</title>
    <meta property="og:description" content="free tool for pdf & image all tool are avalible here free">
     <meta name="description" content="DR.pdf & image is a compleate package of your need at one place free tool for pdf & image all tool are avalible here free,pdf resize, merge pdf ,split pdf,pdf to image,image to pdf,orgnize pdf,sign on pdf, watermaark on pdf,image background remover,image compressor,image resizer,age calculator,word to pdf, excel to pdf,resumr builder,multiple image in one page,edit pdf,many more pdf tools at one place">


<meta name="keywords" content="Dr.PDF & IMG,drpdf&img,dr pdf and image,DR pdf,dr pdf, merg pdf, split pdf, pdf to image ,image to pdf,photo background remover,orgnize pdf,sign on pdf,photo date and name,page number on pdf,watermark on pdf,DR.pdf and image,pdf editoe,resume builder,multiple image,image resizer,age-calculator,image compressor,word to pdf,excel to pdf,pdf multifunction tool">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { margin: 0; background: #0f172a; color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden; display: flex; flex-direction: column; height: 100vh; }
        .nav-top { background: #1e293b; padding: 10px; display: flex; gap: 8px; border-bottom: 2px solid #6366f1; align-items: center; justify-content: center; flex-wrap: wrap; }
        .editor-area { flex: 1; overflow: auto; display: flex; justify-content: center; padding: 20px; background: #334155; }
        canvas { touch-action: none; }
        .btn { cursor: pointer; padding: 6px 12px; font-weight: bold; border-radius: 4px; border: none; background: #475569; color: white; font-size: 12px; }
        .btn.active { background: #6366f1; }
        .controls { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #1e293b; padding: 8px 20px; border-radius: 30px; display: flex; gap: 12px; border: 1px solid #6366f1; z-index: 1000; }
        .setting-box { display: flex; align-items: center; gap: 5px; background: #0f172a; padding: 4px 10px; border-radius: 6px; font-size: 12px; }
        input, select { background: #1e293b; color: white; border: 1px solid #6366f1; padding: 3px; border-radius: 4px; outline: none; }
        #loading { position: fixed; inset:0; background:rgba(0,0,0,0.8); display:none; flex-direction:column; justify-content:center; align-items:center; z-index:9999; }
       
canvas { 
    touch-action: manipulation; /* 'none' ki jagah 'manipulation' use karein */
}
    </style>
</head>
<body>

<div class="nav-top">
    <input type="file" id="fileInput" accept="application/pdf" style="width: 150px;">
    
    <button id="btn-text" class="btn active" onclick="setMode('text')">TEXT</button>
    <button id="btn-white" class="btn" onclick="setMode('white')">üñçÔ∏èWHITENER</button>
    <button id="btn-brush" class="btn" onclick="setMode('brush')">üñåÔ∏è BRUSH</button>
    <button id="btn-eraser" class="btn" onclick="setEraser()">üßΩ ERASER</button>

    <div class="setting-box">
        <select id="fontFamily" onchange="updateStyle()">
            <option value="Arial">Arial</option>
            <option value="Times New Roman">Times</option>
            <option value="Courier New">Courier</option>
            <option value="Verdana">Verdana</option>
        </select>
        <button class="btn" onclick="toggleStyle('bold')"><b>B</b></button>
        <button class="btn" onclick="toggleStyle('italic')"><i>I</i></button>
        <input type="number" id="globalSize" value="25" style="width:40px;" oninput="updateStyle()">
        <input type="color" id="globalColor" value="#ff0000" oninput="updateStyle()">
    </div>

    <button onclick="deleteObj()" style="background:#ef4444;" class="btn">DEL</button>
    <button onclick="savePDF()" style="background:#10b981;" class="btn">Download</button>
</div>

<div class="editor-area">
    <canvas id="c"></canvas>
</div>

<div class="controls">
    <button class="btn" onclick="changePage(-1)">‚óÄ</button>
    <span id="pgInfo">0 / 0</span>
    <button class="btn" onclick="changePage(1)">‚ñ∂</button>
</div>

<div id="loading">
    <div style="width:30px; height:30px; border:3px solid #fff; border-top:3px solid #6366f1; border-radius:50%; animation:spin 1s linear infinite;"></div>
</div>

<script>
    const pdfjs = window['pdfjs-dist/build/pdf'];
    pdfjs.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

    let canvas = new fabric.Canvas('c', { isDrawingMode: false });
    let pdfDoc = null, curPage = 1, mode = 'text';
    let isDrawing = false, startX, startY, activeRect;
    // naya code
  

    // 1. FILE LOAD
    document.getElementById('fileInput').onchange = async (e) => {
        const file = e.target.files[0];
        if(!file) return;
        toggleL(true);
        const reader = new FileReader();
        reader.onload = async function() {
            const typedarray = new Uint8Array(this.result);
            pdfDoc = await pdfjs.getDocument(typedarray).promise;
            renderPage(1);
        };
        reader.readAsArrayBuffer(file);
    };

    // 2. RENDER
    async function renderPage(num) {
        toggleL(true);
        const page = await pdfDoc.getPage(num);
        const viewport = page.getViewport({ scale: 1.5 });
        const tempC = document.createElement('canvas');
        const ctx = tempC.getContext('2d');
        tempC.height = viewport.height; tempC.width = viewport.width;
        await page.render({ canvasContext: ctx, viewport }).promise;
        
        canvas.setDimensions({ width: viewport.width, height: viewport.height });
        fabric.Image.fromURL(tempC.toDataURL(), (img) => {
            canvas.clear();
            canvas.setBackgroundImage(img, canvas.renderAll.bind(canvas));
            document.getElementById('pgInfo').innerText = num + " / " + pdfDoc.numPages;
            toggleL(false);
        });
        curPage = num;
    }

    // 3. TOOLS
    function setMode(m) {
        mode = m;
        canvas.isDrawingMode = (m === 'brush');
        document.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
        document.getElementById('btn-'+m).classList.add('active');

        if (m === 'brush') {
            canvas.freeDrawingBrush = new fabric.PencilBrush(canvas);
            canvas.freeDrawingBrush.width = parseInt(document.getElementById('globalSize').value) || 5;
            canvas.freeDrawingBrush.color = document.getElementById('globalColor').value;
        }
    }

    function setEraser() {
        setMode('brush');
        canvas.freeDrawingBrush.color = 'white'; // Simple eraser for drawing
        document.getElementById('btn-brush').classList.remove('active');
        document.getElementById('btn-eraser').classList.add('active');
    }

    // 4. STYLE UPDATES
    function updateStyle() {
        const obj = canvas.getActiveObject();
        const size = parseInt(document.getElementById('globalSize').value);
        const color = document.getElementById('globalColor').value;
        const font = document.getElementById('fontFamily').value;

        if (obj && obj.type === 'i-text') {
            obj.set({ fontSize: size, fill: color, fontFamily: font });
            canvas.renderAll();
        }
        if(canvas.isDrawingMode && mode === 'brush') {
            canvas.freeDrawingBrush.width = size;
            canvas.freeDrawingBrush.color = color;
        }
    }

    function toggleStyle(type) {
        const obj = canvas.getActiveObject();
        if (obj && obj.type === 'i-text') {
            if (type === 'bold') {
                obj.set('fontWeight', obj.fontWeight === 'bold' ? 'normal' : 'bold');
            } else {
                obj.set('fontStyle', obj.fontStyle === 'italic' ? 'normal' : 'italic');
            }
            canvas.renderAll();
        }
    }

    // 5. MOUSE EVENTS
    canvas.on('mouse:down', (o) => {
        if(mode !== 'white') return;
        isDrawing = true;
        const p = canvas.getPointer(o.e);
        startX = p.x; startY = p.y;
        activeRect = new fabric.Rect({
            left: startX, top: startY, width: 0, height: 0, 
            fill: 'white', strokeWidth: 0, selectable: true
        });
        canvas.add(activeRect);
    });

    canvas.on('mouse:move', (o) => {
        if (!isDrawing || mode !== 'white') return;
        const p = canvas.getPointer(o.e);
        activeRect.set({ width: Math.abs(startX - p.x), height: Math.abs(startY - p.y) });
        if(startX > p.x) activeRect.set({ left: p.x });
        if(startY > p.y) activeRect.set({ top: p.y });
        canvas.renderAll();
    });

    canvas.on('mouse:up', () => isDrawing = false);

    canvas.on('mouse:dblclick', (o) => {
        if(mode !== 'text') return;
        const p = canvas.getPointer(o.e);
        const text = new fabric.IText('Text', {
            left: p.x, top: p.y,
            fontSize: parseInt(document.getElementById('globalSize').value),
            fill: document.getElementById('globalColor').value,
            fontFamily: document.getElementById('fontFamily').value
        });
        canvas.add(text);
        canvas.setActiveObject(text);
        text.enterEditing();
    });

    function deleteObj() {
        canvas.getActiveObjects().forEach(obj => canvas.remove(obj));
        canvas.discardActiveObject().renderAll();
    }

    function changePage(d) {
        if(pdfDoc && curPage+d >= 1 && curPage+d <= pdfDoc.numPages) renderPage(curPage+d);
    }

    function toggleL(s) { document.getElementById('loading').style.display = s ? 'flex' : 'none'; }

    async function savePDF() {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF({ unit: 'px', format: [canvas.width, canvas.height] });
        canvas.discardActiveObject().renderAll();
        pdf.addImage(canvas.toDataURL({format: 'jpeg', quality: 0.7}), 'JPEG', 0, 0, canvas.width, canvas.height);
        // pdf.addImage(canvas.toDataURL({format:'png'}), 'PNG', 0, 0, canvas.width, canvas.height);
        pdf.save("DR.PDF & IMG.pdf");
    }
</script>
<style> @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } </style>
</body>
</html>