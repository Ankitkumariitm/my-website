<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DR.PDF & IMG - A4 Canvas Editor</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --p: #6366f1; --bg: #f1f5f9; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        .header { text-align: center; margin-bottom: 15px; }
        .header h2 { color: var(--p); margin: 0; }

        /* Toolbar */
        .toolbar { background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 20px; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
        .btn { background: var(--p); color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600; }
        .btn-dl { background: #10b981; }
        .btn-del { background: #ef4444; font-size: 12px; padding: 5px 10px; }

        /* A4 Canvas Area */
        #canvas-container { 
            width: 595px; height: 842px; /* A4 Ratio at 72 DPI */
            background: white; position: relative; overflow: hidden;
            box-shadow: 0 0 30px rgba(0,0,0,0.1); border: 1px solid #ddd;
        }

        .draggable { 
            position: absolute; cursor: move; border: 1px solid transparent; 
            user-select: none; display: inline-block;
        }
        .draggable.selected { border: 2px solid var(--p); }
        .draggable img { width: 100%; height: 100%; pointer-events: none; }

        /* Resize Handle */
        .resizer {
            width: 15px; height: 15px; background: var(--p);
            position: absolute; right: -7.5px; bottom: -7.5px;
            cursor: nwse-resize; border-radius: 50%; display: none;
        }
        .selected .resizer { display: block; }

        footer { margin-top: 20px; color: #64748b; font-size: 12px; font-weight: bold; }
        canvas { display: none; }
    </style>
</head>
<body>

<div class="header">
    <h2>DR.PDF & IMG</h2>
    <p>Drag, Resize & Position Images on A4 Page</p>
</div>

<div class="toolbar">
    <input type="file" id="upload" accept="image/*" multiple hidden>
    <button class="btn" onclick="document.getElementById('upload').click()">+ Add Image</button>
    <button class="btn btn-del" onclick="deleteSelected()">Delete Selected</button>
    <button class="btn btn-dl" onclick="exportToJPG()">Download</button>
</div>

<div id="canvas-container"></div>

<footer>Â© 2026 DR.PDF & IMG | Professional Page Editor</footer>

<script>
    const container = document.getElementById('canvas-container');
    let selectedElement = null;

    document.getElementById('upload').onchange = (e) => {
        const files = Array.from(e.target.files);
        files.forEach(file => {
            const reader = new FileReader();
            reader.onload = (ev) => createImageElement(ev.target.result);
            reader.readAsDataURL(file);
        });
    };

    function createImageElement(src) {
        const div = document.createElement('div');
        div.className = 'draggable';
        div.style.width = '150px';
        div.style.left = '50px';
        div.style.top = '50px';

        const img = document.createElement('img');
        img.src = src;
        
        const resizer = document.createElement('div');
        resizer.className = 'resizer';

        div.appendChild(img);
        div.appendChild(resizer);
        container.appendChild(div);

        makeInteractive(div);
    }

    function makeInteractive(el) {
        el.onmousedown = function(e) {
            if (selectedElement) selectedElement.classList.remove('selected');
            selectedElement = el;
            el.classList.add('selected');

            let isResizing = e.target.classList.contains('resizer');
            let startX = e.clientX;
            let startY = e.clientY;
            let startW = parseInt(el.style.width);
            let startL = el.offsetLeft;
            let startT = el.offsetTop;

            document.onmousemove = function(e) {
                if (isResizing) {
                    const newWidth = startW + (e.clientX - startX);
                    if (newWidth > 30) el.style.width = newWidth + 'px';
                } else {
                    el.style.left = (startL + (e.clientX - startX)) + 'px';
                    el.style.top = (startT + (e.clientY - startY)) + 'px';
                }
            };

            document.onmouseup = function() {
                document.onmousemove = null;
                document.onmouseup = null;
            };
        };
    }

    function deleteSelected() {
        if (selectedElement) {
            selectedElement.remove();
            selectedElement = null;
        }
    }

    async function exportToJPG() {
        // Create actual high-res canvas for A4
        const exportCanvas = document.createElement('canvas');
        const ctx = exportCanvas.getContext('2d');
        
        // A4 High Res Scale (approx 2480x3508 for 300 DPI, but we use 2x container for quality)
        const scale = 2; 
        exportCanvas.width = container.offsetWidth * scale;
        exportCanvas.height = container.offsetHeight * scale;

        ctx.fillStyle = "white";
        ctx.fillRect(0, 0, exportCanvas.width, exportCanvas.height);
        ctx.imageSmoothingEnabled = true;
        ctx.imageSmoothingQuality = 'high';

        const items = container.querySelectorAll('.draggable');
        
        for (let item of items) {
            const img = item.querySelector('img');
            const x = item.offsetLeft * scale;
            const y = item.offsetTop * scale;
            const w = item.offsetWidth * scale;
            const h = item.offsetHeight * scale;
            
            ctx.drawImage(img, x, y, w, h);
        }

        const link = document.createElement('a');
        link.download = `DR.PDF_IMG_cobine_Page.jpg`;
        link.href = exportCanvas.toDataURL('image/jpeg', 0.95);
        link.click();
    }
</script>
</body>
</html>